<!DOCTYPE html>
<html lang="fr" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Noa Capital | V46 Manifesto</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: { 
                        dark: '#0f172a', 
                        card: '#1e293b', 
                        accent: '#3b82f6', 
                        success: '#22c55e', 
                        danger: '#ef4444', 
                        gold: '#fbbf24'
                    },
                    fontFamily: { sans: ['Inter', 'sans-serif'] }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #0f172a; color: white; overflow-x: hidden; }
        .tab-content { display: none; width: 100%; animation: fadeIn 0.4s ease-out; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        #home.active { display: flex; flex-direction: column; justify-content: center; align-items: center; min-height: calc(100vh - 64px); }
        .search-glow:focus-within { box-shadow: 0 0 40px rgba(59, 130, 246, 0.25); border-color: #3b82f6; }
        .loader { border: 3px solid #333; border-top: 3px solid #3b82f6; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; display:none; margin: 0 auto; }
        .flash-update { animation: highlight 0.5s ease-out; background-color: rgba(34, 197, 94, 0.1); }
        @keyframes highlight { 0% { background-color: rgba(34, 197, 94, 0.3); } 100% { background-color: transparent; } }
        .scanning-row { border-left: 3px solid #3b82f6; background-color: rgba(59,130,246,0.05); }

        /* Styles LOGIN */
        #login-screen { position: fixed; inset: 0; z-index: 9999; background: #0f172a; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        .login-box { width: 100%; max-width: 400px; padding: 2rem; background: #1e293b; border: 1px solid #334155; border-radius: 1rem; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); text-align: center; }
        .shake { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both; }
        @keyframes shake { 10%, 90% { transform: translate3d(-1px, 0, 0); } 20%, 80% { transform: translate3d(2px, 0, 0); } 30%, 50%, 70% { transform: translate3d(-4px, 0, 0); } 40%, 60% { transform: translate3d(4px, 0, 0); } }
    </style>
</head>

<body class="antialiased min-h-screen flex flex-col">

    <div id="login-screen">
        <div class="mb-8 flex flex-col items-center gap-4">
            <div class="bg-gradient-to-r from-blue-600 to-indigo-600 w-16 h-16 rounded-2xl flex items-center justify-center font-black text-3xl text-white shadow-2xl shadow-blue-900/50">N</div>
            <h1 class="text-3xl font-bold tracking-tight text-white">Noa Capital</h1>
            <p class="text-gray-400 text-sm">V46 Private Access</p>
        </div>
        
        <div class="login-box">
            <div class="mb-6 text-left">
                <label class="block text-xs font-bold text-blue-400 uppercase mb-2">Mot de passe</label>
                <input type="password" id="passwordInput" class="w-full bg-gray-900/50 border border-gray-700 text-white rounded-lg p-3 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none transition" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" onkeypress="if(event.key === 'Enter') checkLogin()">
                <p id="loginError" class="text-red-500 text-xs mt-2 hidden">Acc√®s refus√©. Mot de passe incorrect.</p>
            </div>
            <button onclick="checkLogin()" class="w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 rounded-lg transition shadow-lg shadow-blue-900/20">
                D√©verrouiller
            </button>
        </div>
        <div class="mt-8 text-gray-600 text-xs font-mono">Secured by NC-Protocol v2.1</div>
    </div>

    <div id="app-container" style="display: none;" class="flex-1 flex flex-col w-full h-full">

        <nav class="border-b border-gray-800 bg-card/90 backdrop-blur-md sticky top-0 z-50 h-16">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-full flex items-center justify-between">
                <div class="flex items-center gap-3 cursor-pointer" onclick="switchTab('home')">
                    <div class="bg-gradient-to-r from-blue-600 to-indigo-600 w-9 h-9 rounded-lg flex items-center justify-center font-black text-white shadow-lg">N</div>
                    <span class="text-xl font-bold tracking-tight">Noa Capital</span>
                </div>
                <div class="flex items-center gap-4">
                    <div id="status-badge" class="hidden md:flex items-center gap-2 bg-gray-900/80 px-3 py-1 rounded-full border border-gray-700">
                        <span class="w-2 h-2 rounded-full bg-blue-500" id="status-dot"></span>
                        <span class="text-[10px] font-bold text-blue-500 uppercase tracking-wider" id="status-text">Pr√™t</span>
                    </div>
                    <div class="flex space-x-1 bg-gray-900/50 p-1 rounded-lg border border-gray-700 overflow-x-auto">
                        <button onclick="switchTab('home')" id="btn-home" class="px-4 py-1.5 text-sm font-medium rounded-md bg-blue-600 text-white transition whitespace-nowrap">üîé Recherche</button>
                        <button onclick="switchTab('convictions')" id="btn-convictions" class="px-4 py-1.5 text-sm font-medium rounded-md text-gray-400 hover:text-white transition whitespace-nowrap">Strat√©gie</button>
                        <button onclick="switchTab('dashboard')" id="btn-dashboard" class="px-4 py-1.5 text-sm font-medium rounded-md text-gray-400 hover:text-white transition whitespace-nowrap">Portefeuille</button>
                        <button onclick="switchTab('watchlist')" id="btn-watchlist" class="px-4 py-1.5 text-sm font-medium rounded-md text-gray-400 hover:text-white transition whitespace-nowrap">Surveillance</button>
                        <button onclick="switchTab('simulation')" id="btn-simulation" class="px-4 py-1.5 text-sm font-medium rounded-md text-gray-400 hover:text-white transition whitespace-nowrap">Simulateur</button>
                    </div>
                </div>
            </div>
        </nav>

        <main class="flex-1 w-full">

            <div id="home" class="tab-content active">
                <div class="text-center mb-8 w-full px-4 pt-8">
                    <h1 class="text-5xl font-black text-white mb-4">Market Intelligence.</h1>
                    <p class="text-gray-400">Analyse Technique & Fondamentale.</p>
                </div>
                
                <div class="w-full max-w-3xl px-4 relative z-10 mb-8">
                    <div class="search-glow bg-[#161b22] border border-gray-600 rounded-2xl p-2 flex items-center transition-all duration-300">
                        <input type="text" id="mainTickerInput" class="w-full bg-transparent border-none text-white text-xl px-4 py-4 focus:outline-none placeholder-gray-600 font-medium" placeholder="Rechercher (ex: AI.PA, NVDA)..." onkeypress="if(event.key === 'Enter') searchTicker()">
                        <button onclick="searchTicker()" class="bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 px-8 rounded-xl transition shadow-lg">GO</button>
                    </div>
                    <div class="mt-4 flex justify-center gap-3 text-sm text-gray-500">
                        <button onclick="fillSearch('AI.PA')" class="hover:text-blue-400 transition">Air Liquide</button>
                        <button onclick="fillSearch('MC.PA')" class="hover:text-blue-400 transition">LVMH</button>
                        <button onclick="fillSearch('NVDA')" class="hover:text-blue-400 transition">Nvidia</button>
                    </div>
                </div>
                
                <div id="searchLoader" class="loader mt-10"></div>
                
                <div id="resultCard" class="hidden w-full max-w-5xl px-4 pb-20">
                    <div class="bg-card/90 backdrop-blur border border-gray-700 rounded-2xl shadow-2xl overflow-hidden">
                        <div class="p-6 border-b border-gray-700/50 flex justify-between items-center bg-gray-800/20">
                            <div>
                                <div class="flex items-center gap-3">
                                    <h2 class="text-3xl font-bold text-white" id="res-name">Nom</h2>
                                    <span class="text-xs px-2 py-1 rounded bg-blue-900/30 text-blue-400 border border-blue-800" id="res-type">EQUITY</span>
                                </div>
                                <div class="text-gray-400 text-sm mt-1 font-mono">
                                    <span id="res-symbol">TICKER</span> ‚Ä¢ <span id="res-exchange">Market</span>
                                </div>
                            </div>
                            <div class="text-right">
                                <div class="text-5xl font-black text-white" id="res-price">--</div>
                                <div class="text-xl font-bold flex items-center justify-end gap-2" id="res-perf">-- %</div>
                            </div>
                        </div>

                        <div class="h-[350px] w-full p-4 bg-gray-900/50 relative">
                            <canvas id="searchChart"></canvas>
                        </div>
                        
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-px bg-gray-700/50">
                            <div class="bg-card p-4"><div class="text-[10px] text-gray-500 uppercase font-bold">Ouverture</div><div class="text-lg font-mono text-white" id="res-open">--</div></div>
                            <div class="bg-card p-4"><div class="text-[10px] text-gray-500 uppercase font-bold">Range Jour</div><div class="text-sm font-mono text-white" id="res-range">--</div></div>
                            <div class="bg-card p-4"><div class="text-[10px] text-gray-500 uppercase font-bold">Volume</div><div class="text-lg font-mono text-blue-300" id="res-vol">--</div></div>
                            <div class="bg-card p-4"><div class="text-[10px] text-gray-500 uppercase font-bold">Cap. Boursi√®re</div><div class="text-lg font-mono text-white" id="res-cap">--</div></div>

                            <div class="bg-card p-4 border-t border-gray-700/30"><div class="text-[10px] text-gray-500 uppercase font-bold text-blue-400">PER (P/E)</div><div class="text-xl font-bold text-white" id="res-pe">--</div></div>
                            <div class="bg-card p-4 border-t border-gray-700/30"><div class="text-[10px] text-gray-500 uppercase font-bold text-blue-400">BPA (EPS)</div><div class="text-xl font-bold text-white" id="res-eps">--</div></div>
                            <div class="bg-card p-4 border-t border-gray-700/30"><div class="text-[10px] text-gray-500 uppercase font-bold text-yellow-400">Analystes</div><div class="text-sm font-bold text-white mt-1" id="res-rating">--</div></div>
                            <div class="bg-card p-4 border-t border-gray-700/30"><div class="text-[10px] text-gray-500 uppercase font-bold text-purple-400">B√™ta</div><div class="text-xl font-bold text-white" id="res-beta">--</div></div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="convictions" class="tab-content max-w-5xl mx-auto p-4 sm:p-6 lg:p-8">
                
                <div class="mb-12 border-b border-gray-700 pb-8">
                    <h1 class="text-4xl md:text-5xl font-black text-white tracking-tight mb-6">Th√®se d'Investissement</h1>
                    <p class="text-xl text-gray-400 leading-relaxed max-w-3xl">
                        Pourquoi nous quittons la Tech pour revenir au R√©el. Analyse structurelle d'un changement de paradigme √©conomique.
                    </p>
                </div>

                <div class="mb-16">
                    <h2 class="text-2xl font-bold text-white mb-6 flex items-center gap-3">
                        <span class="text-red-500">01.</span> La Grande Rotation : Fuir la Bulle Tech
                    </h2>
                    <div class="prose prose-invert prose-lg max-w-none text-gray-300 space-y-6 text-justify">
                        <p>
                            Depuis 2010, les march√©s ont √©t√© drogu√©s √† l'argent gratuit (taux z√©ro). Cela a favoris√© les actifs de "croissance longue" comme la Tech, le SaaS et r√©cemment l'IA. Aujourd'hui, les valorisations de la Tech (Nasdaq) ont atteint des niveaux de perfection qui ne tol√®rent aucune erreur. Le PER moyen du secteur d√©passe les 35x, ce qui implique une croissance ininterrompue pour les 10 prochaines ann√©es. <strong>C'est un risque asym√©trique d√©favorable.</strong>
                        </p>
                        <p>
                            Nous assistons au d√©gonflement in√©vitable de cette prime de risque. L'IA est une r√©volution r√©elle, mais les gagnants actuels (Nvidia, Microsoft) sont "pric√©s" pour la perfection. √Ä l'inverse, l'√©conomie r√©elle a √©t√© sous-investie pendant une d√©cennie. Les infrastructures vieillissent, les r√©seaux √©lectriques saturent, et l'offre de mati√®res premi√®res est contrainte.
                        </p>
                        <div class="bg-red-900/10 border-l-4 border-red-500 p-6 rounded-r-lg my-8">
                            <h4 class="font-bold text-red-400 mb-2">Notre D√©cision Radicale</h4>
                            <p class="text-sm">Nous sortons des actifs immat√©riels survaloris√©s pour nous positionner sur des actifs tangibles sous-valoris√©s. Nous pr√©f√©rons poss√©der une mine de cuivre (P/E 12) indispensable √† l'IA, plut√¥t qu'un logiciel (P/E 50) qui pourrait √™tre obsol√®te dans 6 mois.</p>
                        </div>
                    </div>
                </div>

                <div class="mb-16">
                    <h2 class="text-2xl font-bold text-white mb-6 flex items-center gap-3">
                        <span class="text-gold">02.</span> La Croissance Ricardienne (Le Retour du R√©el)
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-8">
                        <div class="bg-card p-6 rounded-xl border border-gray-700">
                            <div class="text-3xl mb-4">‚õèÔ∏è</div>
                            <h3 class="font-bold text-white mb-2">Raret√© Physique</h3>
                            <p class="text-sm text-gray-400">On ne peut pas "imprimer" du cuivre ou de l'√©nergie. L'offre est in√©lastique √† court terme.</p>
                        </div>
                        <div class="bg-card p-6 rounded-xl border border-gray-700">
                            <div class="text-3xl mb-4">üè≠</div>
                            <h3 class="font-bold text-white mb-2">Pricing Power</h3>
                            <p class="text-sm text-gray-400">Les entreprises qui poss√®dent des actifs critiques peuvent monter leurs prix sans perdre de clients.</p>
                        </div>
                        <div class="bg-card p-6 rounded-xl border border-gray-700">
                            <div class="text-3xl mb-4">üõ°Ô∏è</div>
                            <h3 class="font-bold text-white mb-2">Barri√®res √† l'entr√©e</h3>
                            <p class="text-sm text-gray-400">Il faut 15 ans pour ouvrir une mine ou construire une usine chimique. La concurrence est limit√©e.</p>
                        </div>
                    </div>
                    <p class="text-gray-300 leading-relaxed text-justify">
                        Cette strat√©gie vise √† capturer la "Rente de situation" d√©crite par David Ricardo. Dans un monde o√π l'inflation devient structurelle (d√©mographie, d√©globalisation, transition verte), les marges se d√©placent vers l'amont de la cha√Æne de valeur : ceux qui extraient, ceux qui transforment, et ceux qui distribuent l'√©nergie.
                    </p>
                </div>

                <div class="mb-16">
                    <h2 class="text-2xl font-bold text-white mb-6 flex items-center gap-3">
                        <span class="text-blue-500">03.</span> Stock Picking : Pourquoi ces entreprises ?
                    </h2>
                    
                    <div class="space-y-6">
                        <div class="bg-card border border-gray-700 rounded-xl p-6 hover:border-blue-500 transition duration-300">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-xl font-bold text-white">Air Liquide (AI.PA)</h3>
                                <span class="bg-blue-900/30 text-blue-400 px-3 py-1 rounded-full text-xs font-bold border border-blue-500/30">D√âFENSIF</span>
                            </div>
                            <p class="text-gray-400 text-sm leading-relaxed text-justify">
                                C'est la fondation du portefeuille. Air Liquide ne vend pas du gaz, elle vend de la fiabilit√©. Ses contrats de 15 ans incluent des clauses d'indexation sur l'√©nergie. Si l'√©lectricit√© augmente, Air Liquide facture plus cher. C'est l'un des rares "business models" au monde parfaitement prot√©g√© contre l'inflation. De plus, elle est le leader incontest√© de l'hydrog√®ne vert, le carburant du futur pour l'industrie lourde.
                            </p>
                        </div>

                        <div class="bg-card border border-gray-700 rounded-xl p-6 hover:border-gold transition duration-300">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-xl font-bold text-white">ETF Basic Resources (BRES.PA)</h3>
                                <span class="bg-yellow-900/30 text-gold px-3 py-1 rounded-full text-xs font-bold border border-yellow-500/30">OFFENSIF</span>
                            </div>
                            <p class="text-gray-400 text-sm leading-relaxed text-justify">
                                Notre conviction la plus forte. Cet ETF regroupe les g√©ants miniers (Rio Tinto, Glencore, etc.). La th√®se est simple : il n'y a pas de transition √©nerg√©tique sans m√©taux. Une voiture √©lectrique demande 4x plus de cuivre qu'une thermique. L'IA demande des data centers bourr√©s de c√¢bles. L'offre est d√©ficitaire pour la d√©cennie √† venir. C'est un "Super-cycle" qui commence.
                            </p>
                        </div>

                        <div class="bg-card border border-gray-700 rounded-xl p-6 hover:border-red-500 transition duration-300">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-xl font-bold text-white">TotalEnergies (TTE.PA)</h3>
                                <span class="bg-red-900/30 text-red-400 px-3 py-1 rounded-full text-xs font-bold border border-red-500/30">RENDEMENT</span>
                            </div>
                            <p class="text-gray-400 text-sm leading-relaxed text-justify">
                                Le march√© d√©teste le p√©trole par id√©ologie, ce qui nous offre une opportunit√© financi√®re incroyable. Total se paie moins de 8 fois ses b√©n√©fices avec un rendement sur dividende > 5%. Contrairement √† BP ou Shell, Total a gard√© une approche pragmatique : utiliser le cash-flow √©norme du p√©trole pour financer intelligemment sa transition verte sans s'endetter. C'est notre "Vache √† Lait".
                            </p>
                        </div>

                        <div class="bg-card border border-gray-700 rounded-xl p-6 hover:border-green-500 transition duration-300">
                            <div class="flex items-center justify-between mb-4">
                                <h3 class="text-xl font-bold text-white">Schneider Electric (SU.PA)</h3>
                                <span class="bg-green-900/30 text-green-400 px-3 py-1 rounded-full text-xs font-bold border border-green-500/30">CROISSANCE</span>
                            </div>
                            <p class="text-gray-400 text-sm leading-relaxed text-justify">
                                C'est notre fa√ßon de jouer l'Intelligence Artificielle sans payer les multiples absurdes de la Tech. L'IA a besoin de Data Centers. Les Data Centers ont besoin de gestion √©lectrique ultra-complexe pour ne pas surchauffer. Schneider est le leader mondial de la gestion de l'√©nergie et de l'automatisation. C'est le vendeur de "pelles et de pioches" de la ru√©e vers l'or num√©rique.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="mb-12">
                    <h2 class="text-2xl font-bold text-white mb-6 flex items-center gap-3">
                        <span class="text-purple-500">04.</span> La Prochaine Fronti√®re
                    </h2>
                    <div class="bg-gray-900/50 p-6 rounded-xl border border-gray-700">
                        <p class="text-gray-300 text-justify mb-4">
                            Une fois notre socle "Actifs R√©els" consolid√©, nous regarderons vers l'Est et le Sud.
                        </p>
                        <ul class="list-disc list-inside text-gray-400 space-y-2 ml-4">
                            <li><strong>Japon :</strong> Des entreprises riches en cash, une gouvernance qui s'am√©liore, mais un Yen trop faible. Nous attendons le pivot de la Banque du Japon.</li>
                            <li><strong>√âmergents (Inde/Br√©sil) :</strong> La d√©mographie est l√†-bas. La croissance aussi. Mais tant que le Dollar est fort, ces march√©s souffrent. Nous attendons la baisse des taux US pour entrer.</li>
                        </ul>
                    </div>
                </div>

            </div>

            <div id="dashboard" class="tab-content max-w-7xl mx-auto p-4 sm:p-6 lg:p-8">
                <div class="mb-8 flex justify-between items-end">
                    <div>
                        <h1 class="text-3xl font-bold text-white">Portefeuille Global</h1>
                        <p class="text-gray-400 mt-1 text-sm font-mono flex items-center gap-2">
                            <span id="scan-progress" class="hidden text-blue-400 font-bold">...</span>
                            <span id="last-update">En attente de connexion...</span>
                        </p>
                    </div>
                    <div class="text-right"><div class="text-sm text-gray-400 uppercase">AUM Total</div><div class="text-4xl font-extrabold text-white tabular-nums" id="totalVal">-- ‚Ç¨</div></div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
                    <div class="bg-card rounded-xl p-5 border border-gray-700 shadow-lg"><p class="text-xs font-bold text-gray-400 uppercase">Plus-Value</p><p class="mt-1 text-2xl font-bold tabular-nums" id="totalPv">--</p></div>
                    <div class="bg-card rounded-xl p-5 border border-gray-700 shadow-lg"><p class="text-xs font-bold text-gray-400 uppercase">Dividendes</p><p class="mt-1 text-2xl font-bold text-indigo-400 tabular-nums" id="totalDiv">--</p></div>
                    <div class="bg-card rounded-xl p-5 border border-gray-700 shadow-lg"><p class="text-xs font-bold text-gray-400 uppercase">PER Moyen</p><p class="mt-1 text-2xl font-bold text-white tabular-nums" id="avgPER">--</p></div>
                    <div class="bg-card rounded-xl p-5 border border-gray-700 shadow-lg"><p class="text-xs font-bold text-gray-400 uppercase">Top Perf</p><p class="mt-1 text-lg font-bold text-white truncate" id="topStock">--</p><p class="text-xs font-bold text-green-400 mt-1" id="topStockPerf">--</p></div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-2 bg-card rounded-xl border border-gray-700 shadow-lg flex flex-col">
                        <div class="px-6 py-4 border-b border-gray-700 bg-gray-800/30"><h3 class="text-sm font-bold text-white uppercase">Positions Actives</h3></div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left text-sm text-gray-400">
                                <thead class="bg-gray-900/50 uppercase text-xs text-gray-500">
                                    <tr>
                                        <th class="px-5 py-3">Soci√©t√©</th>
                                        <th class="px-5 py-3 text-right">Cours</th>
                                        <th class="px-5 py-3 text-center">Var. J</th>
                                        <th class="px-5 py-3 text-right hidden sm:table-cell">Valo</th>
                                        <th class="px-5 py-3 text-right">Perf</th>
                                        <th class="px-5 py-3 text-center text-blue-400">PER</th>
                                        <th class="px-5 py-3 text-center text-purple-400">PSR</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-gray-700/50" id="tableBody"></tbody>
                            </table>
                        </div>
                    </div>
                    <div class="bg-card rounded-xl border border-gray-700 shadow-lg p-6 flex flex-col">
                        <h3 class="text-sm font-bold text-white uppercase mb-4">Allocation</h3>
                        <div class="flex-1 relative min-h-[250px]"><canvas id="sectorChart"></canvas></div>
                    </div>
                </div>
            </div>

            <div id="watchlist" class="tab-content max-w-7xl mx-auto p-4 sm:p-6 lg:p-8">
                <div class="mb-8"><h1 class="text-3xl font-bold text-white tracking-tight">Liste de Surveillance</h1><p class="text-gray-400 mt-2">Cibles potentielles : Japon & March√©s √âmergents.</p></div>
                <div class="bg-card rounded-xl border border-gray-700 shadow-lg flex flex-col overflow-hidden">
                    <div class="px-6 py-4 border-b border-gray-700 bg-gray-800/30 flex justify-between items-center"><h3 class="text-sm font-bold text-white uppercase">Watchlist</h3><span id="wl-scan-status" class="text-xs text-blue-400 font-mono hidden">Scan...</span></div>
                    <div class="overflow-x-auto"><table class="w-full text-left text-sm text-gray-400"><thead class="bg-gray-900/50 uppercase text-xs text-gray-500"><tr><th class="px-5 py-3">Actif</th><th class="px-5 py-3">Th√®se / Objectif</th><th class="px-5 py-3 text-right">Cours Live</th><th class="px-5 py-3 text-center">Var. J</th><th class="px-5 py-3 text-right text-yellow-400">Statut</th></tr></thead><tbody class="divide-y divide-gray-700/50" id="watchlistBody"></tbody></table></div>
                </div>
            </div>

            <div id="simulation" class="tab-content max-w-7xl mx-auto p-4 sm:p-6 lg:p-8">
                <h1 class="text-3xl font-bold text-white tracking-tight mb-2">Projection</h1>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="bg-card border border-gray-700 rounded-xl p-6 h-fit"><h3 class="font-bold text-white mb-6 uppercase text-sm">Param√®tres</h3><div class="space-y-4"><div><label class="block text-xs font-medium text-gray-400 mb-1">Capital Initial</label><input type="number" id="sim-start" value="10000" class="w-full bg-gray-900 border border-gray-700 rounded p-2 text-white"></div><div><label class="block text-xs font-medium text-gray-400 mb-1">Mensuel</label><input type="number" id="sim-monthly" value="500" class="w-full bg-gray-900 border border-gray-700 rounded p-2 text-white"></div><div><label class="block text-xs font-medium text-gray-400 mb-1">Rendement %</label><input type="number" id="sim-rate" value="8" class="w-full bg-gray-900 border border-gray-700 rounded p-2 text-white"></div><div><label class="block text-xs font-medium text-gray-400 mb-1">Ann√©es</label><input type="number" id="sim-years" value="20" class="w-full bg-gray-900 border border-gray-700 rounded p-2 text-white"></div></div><button onclick="calculateSim()" class="w-full mt-6 bg-blue-600 hover:bg-blue-500 text-white font-bold py-3 rounded transition">Calculer</button></div>
                    <div class="lg:col-span-2 bg-card border border-gray-700 rounded-xl p-6 flex flex-col"><div class="text-center mb-6"><div class="text-sm text-gray-400 uppercase">Capital Final</div><div class="text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-green-400 mt-2" id="sim-result">-- ‚Ç¨</div></div><div class="flex-1 relative min-h-[300px]"><canvas id="simChart"></canvas></div></div>
                </div>
            </div>

        </main>
    </div> <script>
        // --- LOGIQUE DE LOGIN ---
        const PASSWORD_CONFIG = "admin"; // <--- CHANGE LE MOT DE PASSE ICI

        function checkLogin() {
            const input = document.getElementById('passwordInput');
            const box = document.querySelector('.login-box');
            const errorMsg = document.getElementById('loginError');

            if (input.value === PASSWORD_CONFIG) {
                // Succ√®s
                document.getElementById('login-screen').style.transition = 'opacity 0.5s ease';
                document.getElementById('login-screen').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('login-screen').style.display = 'none';
                    document.getElementById('app-container').style.display = 'flex';
                    // Lance le code existant une fois connect√©
                    initApp();
                }, 500);
            } else {
                // Erreur
                errorMsg.classList.remove('hidden');
                box.classList.remove('shake');
                void box.offsetWidth; // trigger reflow
                box.classList.add('shake');
                input.value = '';
                input.focus();
            }
        }

        // --- CODE EXISTANT (ENCAPSUL√â DANS initApp) ---
        
        let portfolio = [
            { tick: "AI.PA",  name: "Air Liquide",        sec: "Chimie",     q: 20, pru: 171.18, div: 0.019, price: 0, prev: 0, eps: 5.90, sps: 53.5, beta: 0.8 },
            { tick: "SU.PA",  name: "Schneider Electric", sec: "Industrie",  q: 10, pru: 236.99, div: 0.015, price: 0, prev: 0, eps: 7.50, sps: 63.0, beta: 1.1 },
            { tick: "TTE.PA", name: "TotalEnergies",      sec: "Energie",    q: 38, pru: 56.97,  div: 0.052, price: 0, prev: 0, eps: 8.00, sps: 70.0, beta: 0.6 },
            { tick: "AIR.PA", name: "Airbus",             sec: "A√©ro.",      q: 5,  pru: 212.46, div: 0.012, price: 0, prev: 0, eps: 4.90, sps: 88.0, beta: 1.2 },
            { tick: "SGO.PA", name: "Saint-Gobain",       sec: "Construct.", q: 7,  pru: 88.15,  div: 0.026, price: 0, prev: 0, eps: 5.50, sps: 96.0, beta: 1.3 },
            { tick: "BRES.PA",name: "ETF Basic Res.",     sec: "Mat√©riaux",  q: 6,  pru: 104.84, div: 0.0,   price: 0, prev: 0, eps: 0,    sps: 0,    beta: 1.0 },
        ];

        let watchlist = [
            { tick: "CJ1.PA", name: "Amundi MSCI Japan", thesis: "Attente rebond Yen", price: 0, prev: 0 },
            { tick: "AEEM.PA", name: "Amundi MSCI Emerging", thesis: "Attente point bas cycle", price: 0, prev: 0 },
            { tick: "EURJPY=X", name: "Forex EUR/JPY", thesis: "Surveillance volatilit√©", price: 0, prev: 0 }
        ];

        // NAV
        function switchTab(id) {
            document.querySelectorAll('.tab-content').forEach(e => e.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            ['home','dashboard','watchlist','convictions','simulation'].forEach(b=>{
                const el=document.getElementById('btn-'+b);
                if(b===id){el.classList.add('bg-blue-600','text-white');el.classList.remove('text-gray-400','bg-transparent')}
                else{el.classList.remove('bg-blue-600','text-white');el.classList.add('text-gray-400','bg-transparent')}
            });
            if(id!=='home') document.getElementById('resultCard').classList.add('hidden');
            if(id==='simulation') calculateSim();
            if(id==='watchlist') setTimeout(startWatchlistFeed, 500); 
        }

        // FETCH ENGINE
        async function fetchPriceRobust(ticker) {
            const proxy = "https://corsproxy.io/?";
            const url = `https://query1.finance.yahoo.com/v8/finance/chart/${ticker}?interval=1d&range=1d&t=${Date.now()}`;
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), 3500); 
            try {
                const response = await fetch(proxy + encodeURIComponent(url), { signal: controller.signal });
                clearTimeout(timeoutId);
                if (!response.ok) throw new Error("HTTP Error");
                const json = await response.json();
                return {
                    price: json.chart.result[0].meta.regularMarketPrice,
                    prev: json.chart.result[0].meta.chartPreviousClose,
                    meta: json.chart.result[0].meta,
                    timestamps: json.chart.result[0].timestamp,
                    quotes: json.chart.result[0].indicators.quote[0].close
                };
            } catch (e) { return null; }
        }

        async function fetchFundamentalsQuote(ticker) {
            const proxy = "https://corsproxy.io/?";
            const url = `https://query1.finance.yahoo.com/v7/finance/quote?symbols=${ticker}&t=${Date.now()}`;
            try {
                const response = await fetch(proxy + encodeURIComponent(url));
                const json = await response.json();
                return json.quoteResponse.result[0];
            } catch(e) { return null; }
        }

        // LIVE FEED PORTFOLIO
        async function startLiveFeed() {
            const dot = document.getElementById('status-dot');
            const label = document.getElementById('scan-progress');
            const updateTxt = document.getElementById('last-update');

            dot.classList.add('bg-blue-500', 'blink');
            label.classList.remove('hidden');
            updateTxt.innerText = "D√©marrage...";

            for (let i = 0; i < portfolio.length; i++) {
                const stock = portfolio[i];
                updateTxt.innerText = `Scan : ${stock.tick}`;
                const row = document.getElementById(`row-${i}`);
                if(row) row.classList.add('scanning-row');

                const data = await fetchPriceRobust(stock.tick);
                if (data && data.price) {
                    stock.price = data.price;
                    stock.prev = data.prev;
                    renderDashboard(i); 
                }
                if(row) row.classList.remove('scanning-row');
                await new Promise(r => setTimeout(r, 1000));
            }

            dot.classList.remove('bg-blue-500', 'blink'); dot.classList.add('bg-green-500');
            updateTxt.innerText = "Mise √† jour OK."; updateTxt.className = "text-green-400 mt-1 text-sm font-mono";
            label.classList.add('hidden');
            renderDashboard(); 
        }

        // LIVE FEED WATCHLIST
        async function startWatchlistFeed() {
            renderWatchlist(); 
            for (let i = 0; i < watchlist.length; i++) {
                const item = watchlist[i];
                const status = document.getElementById('wl-scan-status');
                if(status) { status.classList.remove('hidden'); status.innerText = `Scan: ${item.tick}...`; }
                
                const data = await fetchPriceRobust(item.tick);
                if (data && data.price) {
                    item.price = data.price;
                    item.prev = data.prev;
                    renderWatchlist(i); 
                }
                await new Promise(r => setTimeout(r, 800));
            }
            const status = document.getElementById('wl-scan-status');
            if(status) status.classList.add('hidden');
        }

        // RENDER DASHBOARD
        function renderDashboard(highlightIndex = -1) {
            let totalVal = 0, totalInvest = 0, totalDiv = 0, totalPER = 0, countPER = 0;
            let topStock = { name: '-', perf: -999 };
            const tbody = document.getElementById('tableBody');
            if (highlightIndex === -1) tbody.innerHTML = '';

            portfolio.forEach((stock, index) => {
                const valo = stock.price * stock.q;
                const invest = stock.pru * stock.q;
                
                let perfPct = stock.pru > 0 && stock.price > 0 ? ((stock.price - stock.pru) / stock.pru) * 100 : 0;
                let dayVarPct = stock.price > 0 && stock.prev > 0 ? ((stock.price - stock.prev) / stock.prev) * 100 : 0;
                
                let calculatedPER = (stock.price > 0 && stock.eps > 0) ? stock.price / stock.eps : 0;
                let calculatedPSR = (stock.price > 0 && stock.sps > 0) ? stock.price / stock.sps : 0;

                totalVal += valo; totalInvest += invest; totalDiv += valo * stock.div;
                if(calculatedPER > 0) { totalPER += calculatedPER; countPER++; }
                if(perfPct > topStock.perf) topStock = { name: stock.name, perf: perfPct };
                
                const dPrice = stock.price > 0 ? stock.price.toFixed(2) + " ‚Ç¨" : '...';
                const dValo = stock.price > 0 ? Math.round(valo).toLocaleString() + " ‚Ç¨" : '-';
                const dPerf = stock.price > 0 ? (perfPct > 0 ? '+' : '') + perfPct.toFixed(2) + "%" : '-';
                const cPerf = perfPct >= 0 ? 'text-success' : 'text-danger';
                const dDay = stock.price > 0 ? (dayVarPct > 0 ? '+' : '') + dayVarPct.toFixed(2) + "%" : '-';
                const cDay = dayVarPct >= 0 ? 'text-green-400' : 'text-red-400';
                
                const dPER = calculatedPER > 0 ? calculatedPER.toFixed(2) : '-';
                const dPSR = calculatedPSR > 0 ? calculatedPSR.toFixed(2) : '-';

                if (highlightIndex === -1) {
                    const row = `
                        <tr id="row-${index}" class="hover:bg-gray-800/50 border-b border-gray-700/50 last:border-0">
                            <td class="px-5 py-4"><div class="font-bold text-white">${stock.name}</div><div class="text-[10px] text-gray-500">${stock.tick}</div></td>
                            <td class="px-5 py-4 text-right text-white font-mono" id="price-${index}">${dPrice}</td>
                            <td class="px-5 py-4 text-center font-mono font-bold ${cDay}" id="day-${index}">${dDay}</td>
                            <td class="px-5 py-4 text-right font-bold text-gray-300 hidden sm:table-cell" id="valo-${index}">${dValo}</td>
                            <td class="px-5 py-4 text-right ${cPerf} font-mono font-bold" id="perf-${index}">${dPerf}</td>
                            <td class="px-5 py-4 text-center text-blue-300 font-mono text-sm" id="per-${index}">${dPER}</td>
                            <td class="px-5 py-4 text-center text-purple-400 font-mono text-sm" id="psr-${index}">${dPSR}</td>
                        </tr>`;
                    tbody.innerHTML += row;
                } else if (index === highlightIndex) {
                    const row = document.getElementById(`row-${index}`);
                    row.classList.add('flash-update'); setTimeout(() => row.classList.remove('flash-update'), 500);
                    document.getElementById(`price-${index}`).innerHTML = dPrice;
                    document.getElementById(`day-${index}`).innerHTML = dDay; document.getElementById(`day-${index}`).className = `px-5 py-4 text-center font-mono font-bold ${cDay}`;
                    document.getElementById(`valo-${index}`).innerHTML = dValo;
                    document.getElementById(`perf-${index}`).innerHTML = dPerf; document.getElementById(`perf-${index}`).className = `px-5 py-4 text-right font-mono font-bold ${cPerf}`;
                    document.getElementById(`per-${index}`).innerHTML = dPER;
                    document.getElementById(`psr-${index}`).innerHTML = dPSR;
                }
            });

            if(totalVal > 0) {
                const gpv = totalVal - totalInvest;
                document.getElementById('totalVal').innerText = Math.round(totalVal).toLocaleString() + " ‚Ç¨";
                document.getElementById('totalPv').innerText = (gpv > 0 ? '+' : '') + Math.round(gpv).toLocaleString() + " ‚Ç¨";
                document.getElementById('totalPv').className = `mt-1 text-2xl font-bold tabular-nums ${gpv >= 0 ? 'text-success' : 'text-danger'}`;
                document.getElementById('totalDiv').innerText = Math.round(totalDiv) + " ‚Ç¨";
                document.getElementById('avgPER').innerText = countPER > 0 ? (totalPER/countPER).toFixed(1) : "-";
                document.getElementById('topStock').innerText = topStock.name;
                const topPerfEl = document.getElementById('topStockPerf');
                if(topStock.perf > -999) { topPerfEl.innerText = "+" + topStock.perf.toFixed(2) + " %"; topPerfEl.className = "text-xs font-bold text-green-400 mt-1"; }
            } else {
                document.getElementById('totalVal').innerText = "Chargement...";
            }

            if (highlightIndex === -1 && document.getElementById('sectorChart')) {
                if(window.myChart) window.myChart.destroy();
                const initialData = [20, 15, 30, 10, 10, 15]; 
                window.myChart = new Chart(document.getElementById('sectorChart').getContext('2d'), { type: 'doughnut', data: { labels: portfolio.map(s => s.sec), datasets: [{ data: initialData, backgroundColor: ['#3b82f6', '#8b5cf6', '#10b981', '#f59e0b', '#ef4444', '#ec4899'], borderWidth: 0 }] }, options: { responsive: true, maintainAspectRatio: false, cutout: '70%', plugins: { legend: { position: 'bottom', labels: { color: '#94a3b8', boxWidth: 8, usePointStyle: true } } } } });
            }
        }

        // RENDER WATCHLIST
        function renderWatchlist(highlightIndex = -1) {
            const tbody = document.getElementById('watchlistBody');
            if (highlightIndex === -1) tbody.innerHTML = '';

            watchlist.forEach((item, index) => {
                let dayVarPct = item.price > 0 && item.prev > 0 ? ((item.price - item.prev) / item.prev) * 100 : 0;
                const dPrice = item.price > 0 ? item.price.toFixed(2) : '...';
                const dDay = item.price > 0 ? (dayVarPct > 0 ? '+' : '') + dayVarPct.toFixed(2) + "%" : '-';
                const cDay = dayVarPct >= 0 ? 'text-green-400' : 'text-red-400';

                if (highlightIndex === -1) {
                    const row = `
                        <tr id="wl-row-${index}" class="hover:bg-gray-800/50 border-b border-gray-700/50 last:border-0">
                            <td class="px-5 py-4"><div class="font-bold text-white">${item.name}</div><div class="text-[10px] text-gray-500">${item.tick}</div></td>
                            <td class="px-5 py-4 text-xs text-blue-300">${item.thesis}</td>
                            <td class="px-5 py-4 text-right text-white font-mono" id="wl-price-${index}">${dPrice}</td>
                            <td class="px-5 py-4 text-center font-mono font-bold ${cDay}" id="wl-day-${index}">${dDay}</td>
                            <td class="px-5 py-4 text-right"><span class="bg-yellow-900/30 text-yellow-400 px-2 py-1 rounded text-[10px] uppercase font-bold border border-yellow-700/50">En Attente</span></td>
                        </tr>`;
                    tbody.innerHTML += row;
                } else if (index === highlightIndex) {
                    const row = document.getElementById(`wl-row-${index}`);
                    row.classList.add('flash-update'); setTimeout(() => row.classList.remove('flash-update'), 500);
                    document.getElementById(`wl-price-${index}`).innerText = dPrice;
                    document.getElementById(`wl-day-${index}`).innerText = dDay;
                    document.getElementById(`wl-day-${index}`).className = `px-5 py-4 text-center font-mono font-bold ${cDay}`;
                }
            });
        }

        // SEARCH
        let searchChartInstance = null;
        function fillSearch(t) { document.getElementById('mainTickerInput').value = t; searchTicker(); }
        
        async function searchTicker() {
            const t = document.getElementById('mainTickerInput').value.toUpperCase();
            if(!t) return;
            const card = document.getElementById('resultCard');
            card.classList.add('hidden');
            document.getElementById('searchLoader').style.display = 'block';
            
            const dataChart = await fetchPriceRobust(t);
            const dataQuote = await fetchFundamentalsQuote(t);

            document.getElementById('searchLoader').style.display = 'none';
            
            if(dataChart && dataChart.price) {
                const meta = dataChart.meta;
                const price = dataChart.price;
                const prev = dataChart.prev;
                
                document.getElementById('res-name').innerText = t; 
                document.getElementById('res-symbol').innerText = meta.symbol;
                document.getElementById('res-type').innerText = meta.instrumentType || "EQUITY";
                document.getElementById('res-exchange').innerText = meta.exchangeName;
                document.getElementById('res-price').innerText = price.toFixed(2);
                
                const perf = ((price - prev) / prev) * 100;
                const pEl = document.getElementById('res-perf'); 
                pEl.innerText = (perf > 0 ? '+' : '') + perf.toFixed(2) + " %"; 
                pEl.className = perf >= 0 ? "text-xl font-bold flex items-center justify-end gap-2 text-green-400" : "text-xl font-bold flex items-center justify-end gap-2 text-red-400";

                document.getElementById('res-open').innerText = (meta.regularMarketOpen||prev).toFixed(2);
                document.getElementById('res-range').innerText = (meta.regularMarketDayLow || "-") + " - " + (meta.regularMarketDayHigh || "-");
                let vol = meta.regularMarketVolume || 0; 
                document.getElementById('res-vol').innerText = vol > 1000000 ? (vol/1000000).toFixed(1) + "M" : (vol/1000).toFixed(1) + "K";

                if(dataQuote) {
                    const cap = dataQuote.marketCap || 0;
                    document.getElementById('res-cap').innerText = cap > 1000000000 ? (cap/1000000000).toFixed(2)+"B" : (cap/1000000).toFixed(2)+"M";
                    document.getElementById('res-pe').innerText = dataQuote.trailingPE ? dataQuote.trailingPE.toFixed(2) : "-";
                    document.getElementById('res-eps').innerText = dataQuote.epsTrailingTwelveMonths ? dataQuote.epsTrailingTwelveMonths.toFixed(2) : "-";
                    document.getElementById('res-beta').innerText = dataQuote.beta ? dataQuote.beta.toFixed(2) : "-";
                    const rating = dataQuote.averageAnalystRating || "-";
                    document.getElementById('res-rating').innerText = rating.replace("-", " ").toUpperCase();
                }

                if(dataChart.timestamps && dataChart.quotes) {
                    const ctx = document.getElementById('searchChart').getContext('2d');
                    if(searchChartInstance) searchChartInstance.destroy();
                    const isGreen = price >= prev;
                    const lineColor = isGreen ? '#22c55e' : '#ef4444';
                    const fillColor = isGreen ? 'rgba(34, 197, 94, 0.1)' : 'rgba(239, 68, 68, 0.1)';
                    const clean = dataChart.quotes.map((q,i)=>({t:dataChart.timestamps[i],y:q})).filter(p=>p.y!==null);

                    searchChartInstance = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: clean.map(p => new Date(p.t * 1000).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })),
                            datasets: [{ data: clean.map(p => p.y), borderColor: lineColor, backgroundColor: fillColor, borderWidth: 2, fill: true, pointRadius: 0, tension: 0.1 }]
                        },
                        options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { display: false }, y: { display: true, position: 'right', grid: { color: '#334155' } } } }
                    });
                }
                card.classList.remove('hidden');
            } else { alert("Ticker introuvable"); }
        }

        // SIMU
        let simChartInstance = null;
        function calculateSim() { 
            const start=parseFloat(document.getElementById('sim-start').value), monthly=parseFloat(document.getElementById('sim-monthly').value), rate=parseFloat(document.getElementById('sim-rate').value)/100, years=parseInt(document.getElementById('sim-years').value);
            let capital=start, totalInvested=start, labels=[], dataCapital=[], dataInvested=[];
            for(let i=0;i<=years;i++){
                labels.push("An "+i); dataCapital.push(capital); dataInvested.push(totalInvested);
                if(i<years){ for(let m=0;m<12;m++){ capital+=monthly; capital*=(1+rate/12); totalInvested+=monthly; } }
            }
            document.getElementById('sim-result').innerText=Math.round(dataCapital[dataCapital.length-1]).toLocaleString()+" ‚Ç¨";
            const ctx=document.getElementById('simChart').getContext('2d');
            if(simChartInstance) simChartInstance.destroy();
            simChartInstance = new Chart(ctx,{type:'line',data:{labels,datasets:[{label:'Patrimoine',data:dataCapital,borderColor:'#3b82f6',backgroundColor:'rgba(59,130,246,0.1)',fill:true,tension:0.4},{label:'Investi',data:dataInvested,borderColor:'#64748b',borderDash:[5,5],tension:0.4,pointRadius:0}]},options:{responsive:true,maintainAspectRatio:false,scales:{x:{grid:{display:false}},y:{grid:{color:'#1e293b'}}},plugins:{legend:{labels:{color:'#94a3b8'}}}}});
        }

        // INIT APP (Triggered after login)
        function initApp() {
            calculateSim(); 
            renderDashboard(); 
            setTimeout(startLiveFeed, 1000); 
            setInterval(startLiveFeed, 120000); 
        }

        // Pas de d√©marrage automatique ici, on attend le login.
    </script>
</body>
</html>
